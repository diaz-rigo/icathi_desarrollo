<div class="p-4 sm:p-6 bg-gray-100 ml-0 sm:ml-64">

  <!-- Encabezado con botón - Añadido margen superior -->
  <div
    class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mt-4 sm:mt-6 text-center sm:text-left mb-3">
    <h2 class="text-2xl sm:text-3xl font-bold text-[#44509D] ml-2">Listado de Planteles</h2>
    <button (click)="navigateTo('frm-plantel')"
      class="rounded-full bg-[#F08762] px-5 py-2.5 text-white hover:bg-[#d87552] transition duration-300 flex items-center gap-2 w-full sm:w-auto justify-center">
      <i class="plus icon"></i> Nuevo Plantel
    </button>
  </div>

  <!-- Contenedor de tabla con scroll horizontal y márgenes -->
  <div class="w-full overflow-x-scroll md:overflow-x-auto">
  <div class="inline-block min-w-full align-middle max-h-[600px] overflow-y-auto rounded-md border border-gray-200">
      <table class="min-w-full bg-white border rounded-md shadow-md">
        <thead class="bg-[#44509D] text-white sticky top-0">
          <tr>
            <th class="px-3 py-3 text-left text-xs font-medium uppercase tracking-wider whitespace-nowrap">
              <i class="hashtag icon mr-1"></i>ID
            </th>
            <th
              class="px-3 py-3 text-left text-xs font-medium uppercase tracking-wider whitespace-nowrap min-w-[160px]">
              <i class="address book icon mr-1"></i>Nombre
            </th>
            <th
              class="px-3 py-3 text-left text-xs font-medium uppercase tracking-wider whitespace-nowrap hidden md:table-cell min-w-[180px]">
              <i class="map marker alternate icon mr-1"></i>Dirección
            </th>
            <th
              class="px-3 py-3 text-left text-xs font-medium uppercase tracking-wider whitespace-nowrap hidden sm:table-cell">
              <i class="phone icon mr-1"></i>Teléfono
            </th>
            <th
              class="px-3 py-3 text-left text-xs font-medium uppercase tracking-wider whitespace-nowrap hidden lg:table-cell min-w-[180px]">
              <i class="envelope icon mr-1"></i>Email
            </th>
            <th
              class="px-3 py-3 text-left text-xs font-medium uppercase tracking-wider whitespace-nowrap hidden xl:table-cell min-w-[150px]">
              <i class="user icon mr-1"></i>Director
            </th>
            <th
              class="px-3 py-3 text-left text-xs font-medium uppercase tracking-wider whitespace-nowrap hidden md:table-cell">
              <i class="users icon mr-1"></i>Capacidad
            </th>
            <th
              class="px-3 py-3 text-left text-xs font-medium uppercase tracking-wider whitespace-nowrap hidden lg:table-cell min-w-[120px]">
              <i class="globe icon mr-1"></i>Estado
            </th>
            <th
              class="px-3 py-3 text-left text-xs font-medium uppercase tracking-wider whitespace-nowrap hidden xl:table-cell min-w-[120px]">
              <i class="map icon mr-1"></i>Municipio
            </th>
            <th
              class="px-3 py-3 text-left text-xs font-medium uppercase tracking-wider whitespace-nowrap hidden xl:table-cell">
              <i class="book icon mr-1"></i>Cursos
            </th>
            <th
              class="px-3 py-3 text-left text-xs font-medium uppercase tracking-wider whitespace-nowrap hidden md:table-cell">
              <i class="graduation cap icon mr-1"></i>Alumnos
            </th>
            <th
              class="px-3 py-3 text-center text-xs font-medium uppercase tracking-wider whitespace-nowrap min-w-[100px]">
              <i class="settings icon mr-1"></i>Acciones
            </th>
          </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
          <tr *ngFor="let item of planteles" class="hover:bg-gray-50 transition duration-150">
            <td class="px-3 py-3.5 text-sm text-gray-700 whitespace-nowrap">
              <i class="hashtag icon text-[#44509D]"></i> {{ item.id }}
            </td>
            <td class="px-3 py-3.5 text-sm text-gray-700 whitespace-nowrap font-medium">
              <i class="address book icon text-[#44509D]"></i> {{ item.nombre }}
            </td>
            <td class="px-3 py-3.5 text-sm text-gray-700 whitespace-nowrap hidden md:table-cell">
              <i class="map marker alternate icon text-[#44509D]"></i> {{ item.direccion }}
            </td>
            <td class="px-3 py-3.5 text-sm text-gray-700 whitespace-nowrap hidden sm:table-cell">
              <i class="phone icon text-[#44509D]"></i> {{ item.telefono }}
            </td>
            <td class="px-3 py-3.5 text-sm text-gray-700 whitespace-nowrap hidden lg:table-cell">
              <i class="envelope icon text-[#44509D]"></i> {{ item.email }}
            </td>
            <td class="px-3 py-3.5 text-sm text-gray-700 whitespace-nowrap hidden xl:table-cell">
              <i class="user icon text-[#44509D]"></i> {{ item.director }}
            </td>
            <td class="px-3 py-3.5 text-sm whitespace-nowrap hidden md:table-cell"
              [ngClass]="{'text-green-600': item.capacidad_alumnos > 50, 'text-red-600': item.capacidad_alumnos <= 50}">
              <i class="users icon"></i> {{ item.capacidad_alumnos }}
            </td>
            <td class="px-3 py-3.5 text-sm text-gray-700 whitespace-nowrap hidden lg:table-cell">
              <i class="globe icon text-[#44509D]"></i> {{ item.estado }}
            </td>
            <td class="px-3 py-3.5 text-sm text-gray-700 whitespace-nowrap hidden xl:table-cell">
              <i class="map icon text-[#44509D]"></i> {{ item.municipio }}
            </td>
            <td class="px-3 py-3.5 text-sm text-center whitespace-nowrap hidden xl:table-cell"
              [ngClass]="{'bg-blue-50 text-blue-600': item.total_cursos > 0, 'bg-red-50 text-red-600': item.total_cursos == 0}">
              <i class="book icon"></i>
              <button *ngIf="item.total_cursos > 0" (click)="verDetalleCursos(item.id)"
                class="underline hover:text-blue-800 transition duration-200 ml-1">
                {{ item.total_cursos }}
              </button>
              <span *ngIf="item.total_cursos == 0" class="ml-1">N/A</span>
            </td>
            <td class="px-3 py-3.5 text-sm text-center whitespace-nowrap hidden md:table-cell"
              [ngClass]="{'bg-green-50 text-green-600': item.total_alumnos > 0, 'bg-yellow-50 text-yellow-600': item.total_alumnos == 0}">
              <i class="graduation cap icon"></i> {{ item.total_alumnos || 'N/A' }}
            </td>
            <td class="px-3 py-3.5 text-sm text-center whitespace-nowrap">
              <div class="flex justify-center gap-2">
                <button (click)="openModal(item.id)" title="Editar"
                  class="p-1.5 rounded-md text-white bg-[#44509D] hover:bg-[#364075] transition">
                  <i class="edit icon text-sm"></i>
                </button>
                <button (click)="mostrarModal(item.id)" title="Eliminar"
                  class="p-1.5 rounded-md text-white bg-[#F08762] hover:bg-[#d87552] transition">
                  <i class="trash alternate icon text-sm"></i>
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <!-- </div> -->




  <div *ngIf="isModalOpen" class="fixed inset-0 bg-gray-800 bg-opacity-50 flex justify-center items-center z-50">
    <div class="bg-white rounded-lg shadow-lg p-6 w-full max-w-3xl">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-xl font-bold text-gray-800">
          <i class="edit icon text-[#44509D]"></i> Editar Datos
        </h2>
        <button class="text-gray-600 hover:text-gray-900" (click)="closeModal()">
          ✖
        </button>
      </div>

      <form [formGroup]="editForm" (ngSubmit)="onSubmit()">
        <!-- Nombre -->
        <div class="mb-4">
          <label for="nombre" class="block text-sm font-medium text-[#44509D]">
            <i class="user icon"></i> Nombre
          </label>
          <input type="text" id="nombre" formControlName="nombre" maxlength="100"
            class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-[#44509D] focus:border-[#44509D] sm:text-sm" />
        </div>

        <!-- Dirección -->
        <div class="mb-4">
          <label for="direccion" class="block text-sm font-medium text-[#44509D]">
            <i class="map marker alternate icon"></i> Dirección
          </label>
          <textarea id="direccion" formControlName="direccion"
            class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-[#44509D] focus:border-[#44509D] sm:text-sm"></textarea>
        </div>

        <!-- Teléfono -->
        <div class="mb-4">
          <label for="telefono" class="block text-sm font-medium text-[#44509D]">
            <i class="phone icon"></i> Teléfono
          </label>
          <input type="text" id="telefono" formControlName="telefono" maxlength="15"
            class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-[#44509D] focus:border-[#44509D] sm:text-sm" />
        </div>

        <!-- Email -->
        <div class="mb-4">
          <label for="email" class="block text-sm font-medium text-[#44509D]">
            <i class="envelope icon"></i> Email
          </label>
          <input type="email" id="email" formControlName="email" maxlength="100"
            class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-[#44509D] focus:border-[#44509D] sm:text-sm" />
        </div>

        <!-- Director -->
        <div class="mb-4">
          <label for="director" class="block text-sm font-medium text-[#44509D]">
            <i class="user tie icon"></i> Director
          </label>
          <input type="text" id="director" formControlName="director" maxlength="100"
            class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-[#44509D] focus:border-[#44509D] sm:text-sm" />
        </div>

        <!-- Capacidad de Alumnos -->
        <div class="mb-4">
          <label for="capacidad_alumnos" class="block text-sm font-medium text-[#44509D]">
            <i class="users icon"></i> Capacidad de Alumnos
          </label>
          <input type="number" id="capacidad_alumnos" formControlName="capacidad_alumnos"
            class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-[#44509D] focus:border-[#44509D] sm:text-sm" />
        </div>

        <!-- Estatus -->
        <div class="mb-4 flex items-center">
          <input type="checkbox" id="estatus" formControlName="estatus"
            class="h-4 w-4 text-[#44509D] border-gray-300 rounded focus:ring-[#44509D]" />
          <label for="estatus" class="ml-2 block text-sm text-gray-700">
            <i class="check circle icon"></i> Estatus
          </label>
        </div>

        <!-- Usuario Gestor ID -->
        <!-- <div class="mb-4">
        <label for="usuario_gestor_id" class="block text-sm font-medium text-[#44509D]">
          <i class="id badge icon"></i> Usuario Gestor ID
        </label>
        <input
          type="number"
          id="usuario_gestor_id"
          formControlName="usuario_gestor_id"
          class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-[#44509D] focus:border-[#44509D] sm:text-sm"
        />
      </div> -->

        <!-- Botones -->
        <div class="flex justify-end space-x-4 mt-6">
          <button type="button"
            class="px-4 py-2 bg-gray-300 rounded-md text-gray-700 hover:bg-gray-400 transition duration-300"
            (click)="closeModal()">
            <i class="times icon"></i> Cancelar
          </button>
          <button type="submit"
            class="px-4 py-2 bg-[#44509D] rounded-md text-white hover:bg-[#364075] transition duration-300">
            <i class="save icon"></i> Guardar
          </button>
        </div>
      </form>
    </div>
  </div>


  <!-- Modal de Confirmación -->
  <div class="ui basic modal" #confirmModal>
    <div class="ui icon header">
      <i class="trash icon"></i>
      Confirmar Eliminación
    </div>
    <div class="content">
      <p>¿Estás seguro de que deseas eliminar este elemento? Esta acción no se puede deshacer.</p>
    </div>
    <div class="actions">
      <div class="ui red basic cancel inverted button">
        <i class="remove icon"></i>
        No
      </div>
      <div class="ui green ok inverted button">
        <i class="checkmark icon"></i>
        Sí
      </div>
    </div>
  </div>
</div>


<!-- Modal de Cursos -->
<div *ngIf="isModalOpenverDetalleCursos"
  class="fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-50 backdrop-blur-sm">
  <div class="bg-white rounded-lg shadow-lg w-3/4 md:w-1/2 lg:w-1/3">
    <!-- Header -->
    <div class="flex items-center justify-between px-6 py-4" [style.backgroundColor]="'#44509D'">
      <h2 class="text-xl font-semibold text-white">Detalle de Cursos</h2>
      <button (click)="cerrarModal()" class="text-white hover:text-gray-300">
        <i class="close icon"></i>
      </button>
    </div>

    <!-- Body -->
    <div class="p-6">
      <table class="w-full border-collapse border border-gray-300">
        <thead>
          <tr [style.backgroundColor]="'#F08762'" class="text-white">
            <th class="border border-gray-300 px-4 py-2 text-left">ID</th>
            <th class="border border-gray-300 px-4 py-2 text-left">Nombre</th>
            <th class="border border-gray-300 px-4 py-2 text-left">Duración</th>
            <th class="border border-gray-300 px-4 py-2 text-left">Nivel</th>
            <th class="border border-gray-300 px-4 py-2 text-center">Alumnos</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let curso of cursos">
            <td class="border border-gray-300 px-4 py-2">{{ curso.curso_id }}</td>
            <td class="border border-gray-300 px-4 py-2">{{ curso.curso_nombre }}</td>
            <td class="border border-gray-300 px-4 py-2">{{ curso.duracion_horas }} horas</td>
            <td class="border border-gray-300 px-4 py-2">{{ curso.nivel }}</td>
            <td class="border border-gray-300 px-4 py-2 text-center">
              <button class="bg-[#D8566C] text-white px-3 py-1 rounded hover:bg-red-600"
                (click)="verAlumnosCurso(id_pplantel,curso.curso_id)">
                <i class="users icon"></i> Ver Alumnos
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Footer -->
    <div class="flex justify-end px-6 py-4 border-t">
      <button (click)="cerrarModal()" class="px-4 py-2 bg-gray-700 text-white rounded hover:bg-gray-600">
        Cerrar
      </button>
    </div>
  </div>
</div>

<!-- Modal de Alumnos -->
<div *ngIf="isModalAlumnosOpen"
  class="fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-50 backdrop-blur-sm">
  <div class="bg-white rounded-lg shadow-lg w-3/4 md:w-1/2 lg:w-1/3">
    <!-- Header -->
    <div class="flex items-center justify-between px-6 py-4" [style.backgroundColor]="'#44509D'">
      <h2 class="text-xl font-semibold text-white">Lista de Alumnos</h2>
      <button (click)="cerrarModalAlumnos()" class="text-white hover:text-gray-300">
        <i class="close icon"></i>
      </button>
    </div>
    <div *ngIf="alumnos.length === 0">No hay alumnos inscritos en este curso y plantel.</div>

    <!-- Body -->
    <div class="p-6">
      <ul class="list-disc list-inside">
        <li *ngFor="let alumno of alumnos" class="py-2 text-gray-700">
          <i class="user icon"></i> {{ alumno.nombre }}
        </li>
      </ul>
    </div>

    <!-- Footer -->
    <div class="flex justify-end px-6 py-4 border-t">
      <button (click)="cerrarModalAlumnos()" class="px-4 py-2 bg-gray-700 text-white rounded hover:bg-gray-600">
        Cerrar
      </button>
    </div>
  </div>
</div>