<div class="rounded-2xl border border-slate-200 bg-white/70 backdrop-blur-sm p-4 shadow-sm">
    <!-- Header -->
    <div class="flex items-start justify-between gap-3">
        <div>
            <label class="block text-[13px] font-semibold text-slate-900 tracking-tight">
        {{ label }}
      </label>
            <p class="text-[12px] text-slate-500" *ngIf="targetFolder">Destino: {{ targetFolder }}</p>
        </div>

        <!-- Estado de carga -->
        <div *ngIf="uploading()" class="flex items-center gap-2 text-[12px] text-slate-500">
            <svg class="h-4 w-4 animate-spin" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true">
        <circle cx="12" cy="12" r="9" stroke-width="2" class="opacity-25"></circle>
        <path d="M21 12a9 9 0 0 1-9 9" stroke-width="2" stroke-linecap="round"></path>
      </svg> Subiendo...
        </div>
    </div>

    <!-- Acciones -->
    <div class="mt-3 flex flex-wrap items-center gap-2">
        <label class="inline-flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2.5 text-[13px] font-medium text-slate-700 hover:bg-slate-50 cursor-pointer focus-within:ring-4 focus-within:ring-slate-900/5">
      <input type="file" accept="application/pdf" class="hidden" (change)="onFilePicked($event)" />
      <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true">
        <path stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
              d="M12 16V4m0 12l-3-3m3 3l3-3M5 20h14a2 2 0 0 0 2-2v-3" />
      </svg>
      Subir PDF
    </label>

        <button type="button" class="inline-flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2.5 text-[13px] font-medium text-slate-700 hover:bg-slate-50 disabled:opacity-50" (click)="clear()" [disabled]="!url">
      Limpiar
    </button>

        <span *ngIf="errorMsg()" class="text-[12px] text-red-600">{{ errorMsg() }}</span>
    </div>

    <!-- Card: mini preview -->
    <div class="mt-3">
        <div class="rounded-2xl border border-slate-200 bg-white overflow-hidden shadow-sm">
            <div class="relative p-4">
                <!-- Skeleton -->
                <div *ngIf="!url || !thumbUrl()" class="space-y-3">
                    <div class="h-44 rounded-xl bg-slate-100 animate-pulse"></div>
                    <div class="h-3 w-7/12 rounded-md bg-slate-100 animate-pulse"></div>
                    <div class="h-3 w-4/12 rounded-md bg-slate-100 animate-pulse"></div>
                </div>

                <!-- Mini preview -->
                <div *ngIf="url && thumbUrl()" class="rounded-xl border border-slate-200 bg-slate-50 overflow-hidden">
                    <iframe [src]="thumbUrl()!" class="block h-44 w-full" title="Vista Previa del Documento" loading="lazy" (load)="onThumbLoaded()">
          </iframe>
                </div>
            </div>

            <!-- CTA -->
            <div class="px-4 pb-4 flex items-center justify-between gap-3">
                <a *ngIf="url" [href]="url" target="_blank" rel="noopener" class="inline-flex items-center gap-2 text-[14px] font-semibold text-indigo-600 hover:text-indigo-700 focus:outline-none focus:ring-4 focus:ring-indigo-600/10">
                    <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true">
            <path d="M7 3h6l5 5v13a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1z" stroke-width="2" stroke-linejoin="round"></path>
            <path d="M13 3v5h5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
          </svg> Ver documento
                </a>

                <button type="button" class="inline-flex items-center gap-2 text-[13px] font-medium text-slate-700 hover:text-slate-900 disabled:opacity-50" (click)="toggleFull()" [disabled]="!url">
          {{ showFull() ? 'Ocultar' : 'Ampliar' }} vista
        </button>
            </div>
        </div>
    </div>

    <!-- Vista previa grande -->
    <div *ngIf="showFull() && fullUrl()" class="mt-3 overflow-hidden rounded-xl border border-slate-200 bg-slate-50">
        <iframe [src]="fullUrl()!" class="h-[420px] w-full md:h-[520px]" title="Vista previa PDF" loading="lazy"></iframe>
    </div>
</div>