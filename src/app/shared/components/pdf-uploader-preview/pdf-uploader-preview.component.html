<div class="rounded-2xl border border-slate-200 bg-white/70 backdrop-blur-sm p-4 ">
    <!-- Header -->
    <div class="flex items-start justify-between gap-3">
        <div>
            <label class="block text-[13px] font-semibold text-slate-900 tracking-tight">
        {{ label }}
      </label>
            <p class="text-[12px] text-slate-500" *ngIf="targetFolder">Destino: {{ targetFolder }}</p>
        </div>

        <!-- Estado de carga -->
        <div *ngIf="uploading()" class="flex items-center gap-2 text-[12px] text-slate-500">
            <svg class="h-4 w-4 animate-spin" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true">
        <circle cx="12" cy="12" r="9" stroke-width="2" class="opacity-25"></circle>
        <path d="M21 12a9 9 0 0 1-9 9" stroke-width="2" stroke-linecap="round"></path>
      </svg> Subiendo...
        </div>
    </div>

    <!-- Acciones -->
    <div *ngIf="allowUpload" class="mt-3 flex flex-wrap items-center gap-2">
        <label class="inline-flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2.5 text-[13px] font-medium text-slate-700 hover:bg-slate-50 cursor-pointer focus-within:ring-4 focus-within:ring-slate-900/5">
      <input  type="file" accept="application/pdf" class="hidden" (change)="onFilePicked($event)" />

      <span class="material-symbols-outlined">
cloud_upload
</span>
      Subir PDF
    </label>

        <button type="button" class="inline-flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2.5 text-[13px] font-medium text-slate-700 hover:bg-slate-50 disabled:opacity-50" (click)="clear()" [disabled]="!url">
      <!-- Limpiar -->
      <span class="material-symbols-outlined">
delete
</span>
    </button>

        <span *ngIf="errorMsg()" class="text-[12px] text-red-600">{{ errorMsg() }}</span>
    </div>

    <!-- Card: mini preview -->
    <!-- Card: mini preview (flex-1 para ocupar el espacio vertical) -->
    <div class="mt-3 flex-1">
        <div class="h-full rounded-2xl border border-slate-200 bg-white overflow-hidden shadow-sm">
            <div class="relative p-4">
                <!-- Placeholder / Skeleton con altura fija h-48 -->
                <div *ngIf="!url || !thumbUrl()" class="rounded-xl border border-dashed border-slate-300 bg-slate-50 h-48 grid place-items-center text-center">
                    <div class="flex flex-col items-center gap-2">
                        <!-- Icono archivo -->
                        <svg class="h-8 w-8" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true">
              <path d="M7 3h6l5 5v13a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1z" stroke-width="2" stroke-linejoin="round"></path>
              <path d="M13 3v5h5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
                        <div>
                            <p class="text-sm font-medium text-slate-700">Sin documento</p>
                            <p class="text-xs text-slate-500">Sube un PDF </p>
                        </div>
                    </div>
                </div>

                <!-- Mini preview con la MISMA altura h-48 para uniformidad -->
                <div *ngIf="url && thumbUrl()" class="rounded-xl border border-slate-200 bg-slate-50 overflow-hidden">
                    <iframe [src]="thumbUrl()!" class="block h-48 w-full" title="Vista Previa del Documento" loading="lazy" (load)="onThumbLoaded()">
          </iframe>
                </div>
            </div>

            <!-- CTA pegado abajo -->
            <div class="px-4 pb-4 flex items-center justify-between gap-3">
                <a *ngIf="url" [href]="url" target="_blank" rel="noopener" class="inline-flex items-center gap-2 text-[14px] font-semibold text-indigo-600 hover:text-indigo-700 focus:outline-none focus:ring-4 focus:ring-indigo-600/10">
                    <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true">
            <path d="M7 3h6l5 5v13a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1z" stroke-width="2" stroke-linejoin="round"></path>
            <path d="M13 3v5h5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
          </svg> Ver documento
                </a>

                <!-- <button type="button" class="inline-flex items-center gap-2 text-[13px] font-medium text-slate-700 hover:text-slate-900 disabled:opacity-50" (click)="toggleFull()" [disabled]="!url">
          {{ showFull() ? 'Ocultar' : 'Ampliar' }} vista
        </button> -->
            </div>
        </div>
    </div>

    <!-- Vista previa grande -->
    <div *ngIf="showFull() && fullUrl()" class="mt-3 overflow-hidden rounded-xl border border-slate-200 bg-slate-50">
        <iframe [src]="fullUrl()!" class="h-[420px] w-full md:h-[520px]" title="Vista previa PDF" loading="lazy"></iframe>
    </div>
</div>